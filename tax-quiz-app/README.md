# 税务师考试学习系统 v2.0

一个基于间隔重复算法的税务师考试学习应用，使用 IndexedDB 进行本地数据存储。支持多种题型、Markdown富文本和全局搜索功能。

## 🌟 新功能 (v2.0)

### 多种题型支持
- **问答题 (QA)** - 传统的问答模式，查看问题后点击显示答案
- **填空题 (Fill-in-the-Blank)** - 问题中包含空白处，需要记忆被挖空的内容
- **输入题 (Type-in-Answer)** - 主动输入答案，系统自动判断对错
- **选择题 (Multiple Choice)** - 从多个选项中选择正确答案

### 富文本支持
- **Markdown渲染** - 支持加粗、斜体、标题、列表、表格等格式
- **代码高亮** - 支持代码块显示
- **表格支持** - 可在题库中使用表格格式
- **引用格式** - 支持引用和强调格式

### 全局搜索
- **实时搜索** - 输入即搜，无需点击搜索按钮
- **全文检索** - 搜索题目、答案、分类等所有文本内容
- **快速跳转** - 点击搜索结果直接跳转到对应题目
- **搜索高亮** - 搜索结果中关键词的视觉反馈

### 图片支持
- **图片上传** - 为每张卡片添加相关图片
- **图片显示** - 卡片学习时自动显示关联图片
- **格式支持** - 支持JPG、PNG、GIF等常见图片格式
- **大小限制** - 单张图片最大5MB
- **数据同步** - 图片随卡片数据一起导入导出

## 功能特性

### 核心功能
- **间隔重复学习系统** - 基于艾宾浩斯遗忘曲线的智能复习调度
- **3D卡片翻转界面** - 流畅的CSS3动画效果
- **本地数据存储** - 使用 IndexedDB 存储所有学习数据
- **离线工作能力** - 无需网络连接即可正常使用
- **用户进度同步** - 自动保存学习进度到本地数据库

### 数据管理
- **JSON导入功能** - 支持导入题库JSON文件
- **数据导出功能** - 一键导出学习进度和题库数据
- **数据清空重置** - 支持清空数据并重置为示例题库
- **本地用户管理** - 基于localStorage的用户身份识别

### 学习统计
- **今日复习统计** - 显示今日需要复习的卡片数量
- **总体学习进度** - 实时显示学习完成百分比
- **掌握情况统计** - 区分已掌握和学习中的卡片数量

## 技术架构

### 前端技术栈
- **纯HTML5/CSS3/JavaScript** - 无框架依赖，最大兼容性
- **IndexedDB** - 客户端数据库，存储卡片、进度和用户数据
- **CSS3动画** - 3D卡片翻转效果和过渡动画
- **响应式设计** - 移动端优化的触摸交互

### 数据库结构
应用使用 IndexedDB 存储三个主要数据表：

#### cards 表（卡片数据）
```javascript
{
  id: 1,                    // 卡片ID（主键）
  question: "问题内容",     // 题目问题（支持Markdown）
  answer: "答案内容",       // 题目答案（支持Markdown）
  category: "分类",         // 题目分类
  difficulty: "难度",        // 难度等级
  cardType: "qa",           // 题型：qa/fill_in_blank/type_in/mcq
  options: [],             // 选择题选项（仅mcq题型）
  correctAnswer: 0          // 选择题正确答案索引（仅mcq题型）
}
```

#### progress 表（学习进度）
```javascript
{
  cardId: 1,               // 卡片ID（复合主键）
  userId: "user_xxx",      // 用户ID（复合主键）
  level: 2,                // 当前掌握等级 (0-7)
  reviewDate: "2024-01-01", // 下次复习日期
  lastUpdated: "2024-01-01T00:00:00Z" // 最后更新时间
}
```

#### images 表（图片存储）
```javascript
{
  id: 1,                   // 图片ID（自增主键）
  cardId: 1,               // 关联的卡片ID
  data: "base64_encoded_image_data", // 图片Base64数据
  uploadedAt: "2024-01-01T00:00:00Z" // 上传时间
}
```

#### decks 表（卡组管理）
```javascript
{
  id: 1,                   // 卡组ID（自增主键）
  name: "卡组名称",        // 卡组名称
  description: "描述",      // 卡组描述
  cardIds: [1, 2, 3]      // 包含的卡片ID列表
}
```

## 间隔重复算法

系统实现了科学的间隔重复算法：

### 等级和时间间隔
- **等级 0**: 1天后复习
- **等级 1**: 2天后复习  
- **等级 2**: 4天后复习
- **等级 3**: 8天后复习
- **等级 4**: 16天后复习
- **等级 5**: 32天后复习（已掌握）
- **等级 6**: 64天后复习（熟练掌握）
- **等级 7**: 128天后复习（完全掌握）

### 算法逻辑
- **回答正确**: 升级到下一等级，复习时间间隔翻倍
- **回答错误**: 重置到等级0，第二天重新复习
- **卡片选择**: 优先显示到期复习的卡片，按时间排序

## 使用方法

### 本地开发
```bash
# 进入项目目录
cd tax-quiz-app

# 启动本地开发服务器
python3 -m http.server 8000

# 在浏览器中打开
open http://localhost:8000
```

### 直接运行
```bash
# 直接用浏览器打开index.html文件
open index.html
```

### 数据管理

#### 导入题库
1. 准备符合格式的JSON文件（参考sample-data.json）
2. 点击"导入题库"按钮
3. 选择JSON文件进行导入

#### 导出数据
1. 点击"导出数据"按钮
2. 自动下载包含所有学习数据的JSON文件
3. 可用于备份或数据迁移

#### 重置数据
1. 点击"清空数据"按钮
2. 确认操作后清空所有数据
3. 自动加载示例题库

### 添加图片
1. 浏览到要添加图片的卡片
2. 点击"添加图片"按钮
3. 选择图片文件（支持JPG、PNG、GIF，最大5MB）
4. 图片将自动显示在卡片上
5. 图片会随数据一起导入导出

## 题型说明

### 1. 问答题 (qa)
传统的问答模式，用户查看问题后点击"查看答案"显示答案。

```json
{
  "id": 1,
  "question": "增值税的基本税率是多少？",
  "answer": "增值税的基本税率为13%",
  "cardType": "qa"
}
```

### 2. 填空题 (fill_in_blank)
问题中包含空白处，用户需要记忆被挖空的内容。支持 `___` 和 `{{c1::答案}}` 两种格式。

```json
{
  "id": 2,
  "question": "增值税的___税率是多少？",
  "answer": "13%",
  "cardType": "fill_in_blank"
}
```

### 3. 输入题 (type_in)
用户需要主动输入答案，系统自动判断对错。

```json
{
  "id": 3,
  "question": "请输入增值税的基本税率：",
  "answer": "13%",
  "cardType": "type_in"
}
```

### 4. 选择题 (mcq)
从多个选项中选择正确答案。

```json
{
  "id": 4,
  "question": "增值税的基本税率是：",
  "answer": "13%",
  "cardType": "mcq",
  "options": ["6%", "9%", "13%", "16%"],
  "correctAnswer": 2
}
```

## 数据格式说明

### 题库JSON格式
```json
{
  "cards": [
    {
      "id": 1,
      "question": "问题内容（支持Markdown）",
      "answer": "答案内容（支持Markdown）", 
      "category": "分类",
      "difficulty": "难度",
      "cardType": "题型",
      "options": [],  // 选择题选项
      "correctAnswer": 0  // 选择题正确答案
    }
  ],
  "decks": [
    {
      "id": 1,
      "name": "卡组名称",
      "description": "卡组描述",
      "cardIds": [1, 2, 3]
    }
  ]
}
```

### 导出数据格式
```json
{
  "cards": [...],
  "progress": [...],
  "exportDate": "2024-01-01T00:00:00Z",
  "version": "1.0"
}
```

## 浏览器兼容性

- **现代浏览器**: Chrome 58+, Firefox 55+, Safari 10+, Edge 79+
- **移动设备**: iOS Safari, Android Chrome
- **IndexedDB支持**: 需要浏览器支持IndexedDB API

## 部署说明

### 静态托管
应用完全基于客户端技术，可以部署到任何静态托管服务：
- **GitHub Pages**: 免费公共仓库托管
- **Netlify/Vercel**: 现代静态托管平台
- **AWS S3 + CloudFront**: 企业级解决方案

### 注意事项
- 所有数据存储在浏览器本地，更换浏览器或设备会丢失数据
- 建议定期导出数据进行备份
- 清空浏览器数据会删除所有学习记录

## 开发说明

### 文件结构
```
tax-quiz-app/
├── index.html          # 主页面
├── style.css           # 样式文件
├── script.js           # 主要逻辑
├── sample-data.json    # 示例题库
└── README.md           # 说明文档
```

### 主要类和方法
- **TaxQuizApp**: 主应用类
- **initDatabase():** 初始化IndexedDB
- **dbOperation():** 数据库操作封装
- **saveProgress():** 保存学习进度
- **calculateNextReviewDate():** 计算下次复习时间
- **showNextCard():** 显示下一张卡片
- **renderCardByType():** 根据题型渲染不同界面
- **performSearch():** 执行全局搜索
- **submitTypeAnswer():** 提交输入题答案
- **selectMCQOption():** 选择题选项处理

### 核心算法
- **间隔重复算法**: 基于 [1, 2, 4, 8, 16, 32, 64, 128] 天的复习间隔
- **题型识别**: 根据 cardType 字段动态渲染不同学习界面
- **搜索算法**: 全文模糊匹配，支持题目、答案、分类检索
- **Markdown渲染**: 使用 marked.js 安全渲染富文本内容

### 扩展功能
可以基于现有架构扩展以下功能：
- 🎯 **学习分析**: 更详细的学习数据统计和分析图表
- 🎵 **多媒体支持**: 音频、视频、图片等多媒体学习内容
- 👥 **多用户系统**: 支持多个用户账户和学习进度同步
- 📊 **智能推荐**: 基于学习表现推荐相关题目
- 🌐 **云端同步**: 与云端服务器同步学习进度
- 📱 **移动应用**: 基于PWA技术的移动端应用
- 🤖 **AI助手**: 智能答题和学习建议
- 🎮 **游戏化**: 积分、成就、排行榜等游戏化元素

## 许可证

本项目仅供学习和研究使用。