# ç¨åŠ¡å­¦ä¹ å¹³å° (Tax Learning Platform)

åŸºäºMongoDBçš„ç¨åŠ¡è€ƒè¯•å­¦ä¹ ç³»ç»Ÿï¼Œæ”¯æŒé—´éš”é‡å¤ç®—æ³•å’Œæ™ºèƒ½æ¨èã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 16+
- MongoDB 8.2+
- npm æˆ– yarn

### å®‰è£…ä¾èµ–
```bash
npm install
```

### æ•°æ®åº“åˆå§‹åŒ–
```bash
# é‡ç½®å¹¶åˆå§‹åŒ–æ•°æ®åº“
npm run reset-db

# æˆ–è€…åˆ†æ­¥æ‰§è¡Œ
npm run init-db      # åˆå§‹åŒ–æ•°æ®
npm run create-indexes  # åˆ›å»ºç´¢å¼•
npm run test-db      # éªŒè¯æ•°æ®åº“
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
npm run dev
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ package.json              # é¡¹ç›®é…ç½®
â”œâ”€â”€ scripts/                  # æ•°æ®åº“è„šæœ¬
â”‚   â”œâ”€â”€ init-database.js     # æ•°æ®åº“åˆå§‹åŒ–
â”‚   â”œâ”€â”€ create-indexes.js    # ç´¢å¼•åˆ›å»º
â”‚   â””â”€â”€ test-queries.js      # åŠŸèƒ½éªŒè¯
â””â”€â”€ server/                   # åç«¯ä»£ç  (å¾…å¼€å‘)
    â””â”€â”€ app.js              # Expressåº”ç”¨
```

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### é›†åˆç»“æ„

#### `knowledge_points` - çŸ¥è¯†ç‚¹é›†åˆ
```javascript
{
  topic: "ç¯å¢ƒä¿æŠ¤ç¨",           // ç¨ç§
  main_topic: "æ¦‚å¿µå’Œå¾ç¨èŒƒå›´",   // ä¸»è¦ç« èŠ‚
  sub_topic: "çº³ç¨äºº",          // å…·ä½“çŸ¥è¯†ç‚¹
  content: "çŸ¥è¯†ç‚¹å†…å®¹...",
  key_points: ["é‡ç‚¹1", "é‡ç‚¹2"], // è€ƒç‚¹é‡ç‚¹
  tags: ["çº³ç¨äºº", "ç¯ä¿ç¨"],    // æ ‡ç­¾
  display_order: 1              // æ˜¾ç¤ºé¡ºåº
}
```

#### `quizzes` - é¢˜ç›®é›†åˆ
```javascript
{
  type: "multiple_choice",      // é¢˜ç›®ç±»å‹
  question_text: "é¢˜ç›®å†…å®¹...",
  options: [{key: "A", text: "é€‰é¡¹A"}],
  correct_answer: ["A", "C"],   // æ­£ç¡®ç­”æ¡ˆ
  explanation: "è§£æå†…å®¹...",
  difficulty: "medium",         // éš¾åº¦
  source: "2019å¹´çœŸé¢˜"          // æ¥æº
}
```

#### `users` - ç”¨æˆ·é›†åˆ
```javascript
{
  user_id: "unique_id",
  nickname: "ç”¨æˆ·æ˜µç§°",
  phone: "15630827927",
  learning_progress: [{         // å­¦ä¹ è¿›åº¦
    point_id: ObjectId,
    status: "learned",
    last_studied_at: Date
  }],
  quiz_history: [{             // ç­”é¢˜å†å²
    quiz_id: ObjectId,
    user_answer: ["A", "B"],
    is_correct: true
  }]
}
```

## ğŸ“Š æ•°æ®éªŒè¯

è¿è¡ŒéªŒè¯è„šæœ¬ç¡®è®¤æ•°æ®åº“åŠŸèƒ½ï¼š
```bash
npm run test-db
```

éªŒè¯åŒ…æ‹¬ï¼š
- âœ… åŸºç¡€æ•°æ®æŸ¥è¯¢
- âœ… å±‚çº§æŸ¥è¯¢åŠŸèƒ½
- âœ… å…³è”æŸ¥è¯¢åŠŸèƒ½
- âœ… å…¨æ–‡æœç´¢åŠŸèƒ½
- âœ… ç”¨æˆ·æ•°æ®æŸ¥è¯¢
- âœ… å¤æ‚æŸ¥è¯¢åœºæ™¯
- âœ… ç´¢å¼•ä½¿ç”¨æƒ…å†µ

## ğŸ”§ å¼€å‘è„šæœ¬

- `npm start` - å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
- `npm run dev` - å¯åŠ¨å¼€å‘æœåŠ¡å™¨ (nodemon)
- `npm run reset-db` - é‡ç½®æ•°æ®åº“
- `npm run test-db` - éªŒè¯æ•°æ®åº“åŠŸèƒ½

## ğŸ“ˆ å½“å‰çŠ¶æ€

- âœ… MongoDBæ•°æ®åº“è®¾è®¡å®Œæˆ
- âœ… ç´¢å¼•ä¼˜åŒ–å®Œæˆ
- âœ… æ•°æ®éªŒè¯è„šæœ¬å®Œæˆ
- â³ Expressåç«¯APIå¼€å‘ä¸­
- â³ å‰ç«¯ç•Œé¢å¼€å‘å¾…å¼€å§‹

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

1. å¼€å‘Expressåç«¯API
2. å®ç°ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
3. å¼€å‘å‰ç«¯å­¦ä¹ ç•Œé¢
4. å®ç°é—´éš”é‡å¤ç®—æ³•
5. æ·»åŠ å­¦ä¹ ç»Ÿè®¡åŠŸèƒ½